# ---- UI build ----
FROM node:20-alpine AS ui-build
WORKDIR /ui

COPY ui/package.json ui/package-lock.json* ./
RUN npm install

COPY ui/ ./
RUN npm run build

# ---- UI runtime ----
FROM nginx:1.27-alpine

COPY docker/nginx.ui.conf /etc/nginx/conf.d/default.conf
COPY --from=ui-build /ui/dist /usr/share/nginx/html/app

EXPOSE 80
